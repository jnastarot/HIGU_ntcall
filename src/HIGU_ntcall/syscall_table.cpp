#include "pch.h"
#include "syscall_table.h"


static const char* syscall_table_names[SYSCALL_TABLE_MAX] = {
   "NtAcceptConnectPort",
   "NtAccessCheck",
   "NtAccessCheckAndAuditAlarm",
   "NtAccessCheckByType",
   "NtAccessCheckByTypeAndAuditAlarm",
   "NtAccessCheckByTypeResultList",
   "NtAccessCheckByTypeResultListAndAuditAlarm",
   "NtAccessCheckByTypeResultListAndAuditAlarmByHandle",
   "NtAcquireProcessActivityReference",
   "NtAddAtom",
   "NtAddAtomEx",
   "NtAddBootEntry",
   "NtAddDriverEntry",
   "NtAdjustGroupsToken",
   "NtAdjustPrivilegesToken",
   "NtAdjustTokenClaimsAndDeviceGroups",
   "NtAlertResumeThread",
   "NtAlertThread",
   "NtAlertThreadByThreadId",
   "NtAllocateLocallyUniqueId",
   "NtAllocateReserveObject",
   "NtAllocateUserPhysicalPages",
   "NtAllocateUuids",
   "NtAllocateVirtualMemory",
   "NtAllocateVirtualMemoryEx",
   "NtAlpcAcceptConnectPort",
   "NtAlpcCancelMessage",
   "NtAlpcConnectPort",
   "NtAlpcConnectPortEx",
   "NtAlpcCreatePort",
   "NtAlpcCreatePortSection",
   "NtAlpcCreateResourceReserve",
   "NtAlpcCreateSectionView",
   "NtAlpcCreateSecurityContext",
   "NtAlpcDeletePortSection",
   "NtAlpcDeleteResourceReserve",
   "NtAlpcDeleteSectionView",
   "NtAlpcDeleteSecurityContext",
   "NtAlpcDisconnectPort",
   "NtAlpcImpersonateClientContainerOfPort",
   "NtAlpcImpersonateClientOfPort",
   "NtAlpcOpenSenderProcess",
   "NtAlpcOpenSenderThread",
   "NtAlpcQueryInformation",
   "NtAlpcQueryInformationMessage",
   "NtAlpcRevokeSecurityContext",
   "NtAlpcSendWaitReceivePort",
   "NtAlpcSetInformation",
   "NtApphelpCacheControl",
   "NtAreMappedFilesTheSame",
   "NtAssignProcessToJobObject",
   "NtAssociateWaitCompletionPacket",
   "NtCallEnclave",
   "NtCallbackReturn",
   "NtCancelIoFile",
   "NtCancelIoFileEx",
   "NtCancelSynchronousIoFile",
   "NtCancelTimer",
   "NtCancelTimer2",
   "NtCancelWaitCompletionPacket",
   "NtClearEvent",
   "NtClose",
   "NtCloseObjectAuditAlarm",
   "NtCommitComplete",
   "NtCommitEnlistment",
   "NtCommitRegistryTransaction",
   "NtCommitTransaction",
   "NtCompactKeys",
   "NtCompareObjects",
   "NtCompareSigningLevels",
   "NtCompareTokens",
   "NtCompleteConnectPort",
   "NtCompressKey",
   "NtConnectPort",
   "NtContinue",
   "NtConvertBetweenAuxiliaryCounterAndPerformanceCounter",
   "NtCreateCrossVmEvent",
   "NtCreateDebugObject",
   "NtCreateDirectoryObject",
   "NtCreateDirectoryObjectEx",
   "NtCreateEnclave",
   "NtCreateEnlistment",
   "NtCreateEvent",
   "NtCreateEventPair",
   "NtCreateFile",
   "NtCreateIRTimer",
   "NtCreateIoCompletion",
   "NtCreateJobObject",
   "NtCreateJobSet",
   "NtCreateKey",
   "NtCreateKeyTransacted",
   "NtCreateKeyedEvent",
   "NtCreateLowBoxToken",
   "NtCreateMailslotFile",
   "NtCreateMutant",
   "NtCreateNamedPipeFile",
   "NtCreatePagingFile",
   "NtCreatePartition",
   "NtCreatePort",
   "NtCreatePrivateNamespace",
   "NtCreateProcess",
   "NtCreateProcessEx",
   "NtCreateProfile",
   "NtCreateProfileEx",
   "NtCreateRegistryTransaction",
   "NtCreateResourceManager",
   "NtCreateSection",
   "NtCreateSectionEx",
   "NtCreateSemaphore",
   "NtCreateSymbolicLinkObject",
   "NtCreateThread",
   "NtCreateThreadEx",
   "NtCreateTimer",
   "NtCreateTimer2",
   "NtCreateToken",
   "NtCreateTokenEx",
   "NtCreateTransaction",
   "NtCreateTransactionManager",
   "NtCreateUserProcess",
   "NtCreateWaitCompletionPacket",
   "NtCreateWaitablePort",
   "NtCreateWnfStateName",
   "NtCreateWorkerFactory",
   "NtDebugActiveProcess",
   "NtDebugContinue",
   "NtDelayExecution",
   "NtDeleteAtom",
   "NtDeleteBootEntry",
   "NtDeleteDriverEntry",
   "NtDeleteFile",
   "NtDeleteKey",
   "NtDeleteObjectAuditAlarm",
   "NtDeletePrivateNamespace",
   "NtDeleteValueKey",
   "NtDeleteWnfStateData",
   "NtDeleteWnfStateName",
   "NtDeviceIoControlFile",
   "NtDisableLastKnownGood",
   "NtDisplayString",
   "NtDrawText",
   "NtDuplicateObject",
   "NtDuplicateToken",
   "NtEnableLastKnownGood",
   "NtEnumerateBootEntries",
   "NtEnumerateDriverEntries",
   "NtEnumerateKey",
   "NtEnumerateSystemEnvironmentValuesEx",
   "NtEnumerateTransactionObject",
   "NtEnumerateValueKey",
   "NtExtendSection",
   "NtFilterBootOption",
   "NtFilterToken",
   "NtFilterTokenEx",
   "NtFindAtom",
   "NtFlushBuffersFile",
   "NtFlushBuffersFileEx",
   "NtFlushInstallUILanguage",
   "NtFlushInstructionCache",
   "NtFlushKey",
   "NtFlushProcessWriteBuffers",
   "NtFlushVirtualMemory",
   "NtFlushWriteBuffer",
   "NtFreeUserPhysicalPages",
   "NtFreeVirtualMemory",
   "NtFreezeRegistry",
   "NtFreezeTransactions",
   "NtFsControlFile",
   "NtGetCachedSigningLevel",
   "NtGetCompleteWnfStateSubscription",
   "NtGetContextThread",
   "NtGetCurrentProcessorNumber",
   "NtGetCurrentProcessorNumberEx",
   "NtGetDevicePowerState",
   "NtGetMUIRegistryInfo",
   "NtGetNextProcess",
   "NtGetNextThread",
   "NtGetNlsSectionPtr",
   "NtGetNotificationResourceManager",
   "NtGetWriteWatch",
   "NtImpersonateAnonymousToken",
   "NtImpersonateClientOfPort",
   "NtImpersonateThread",
   "NtInitializeEnclave",
   "NtInitializeNlsFiles",
   "NtInitializeRegistry",
   "NtInitiatePowerAction",
   "NtIsProcessInJob",
   "NtIsSystemResumeAutomatic",
   "NtIsUILanguageComitted",
   "NtListenPort",
   "NtLoadDriver",
   "NtLoadEnclaveData",
   "NtLoadKey",
   "NtLoadKey2",
   "NtLoadKeyEx",
   "NtLockFile",
   "NtLockProductActivationKeys",
   "NtLockRegistryKey",
   "NtLockVirtualMemory",
   "NtMakePermanentObject",
   "NtMakeTemporaryObject",
   "NtManageHotPatch",
   "NtManagePartition",
   "NtMapCMFModule",
   "NtMapUserPhysicalPages",
   "NtMapUserPhysicalPagesScatter",
   "NtMapViewOfSection",
   "NtMapViewOfSectionEx",
   "NtModifyBootEntry",
   "NtModifyDriverEntry",
   "NtNotifyChangeDirectoryFile",
   "NtNotifyChangeDirectoryFileEx",
   "NtNotifyChangeKey",
   "NtNotifyChangeMultipleKeys",
   "NtNotifyChangeSession",
   "NtOpenDirectoryObject",
   "NtOpenEnlistment",
   "NtOpenEvent",
   "NtOpenEventPair",
   "NtOpenFile",
   "NtOpenIoCompletion",
   "NtOpenJobObject",
   "NtOpenKey",
   "NtOpenKeyEx",
   "NtOpenKeyTransacted",
   "NtOpenKeyTransactedEx",
   "NtOpenKeyedEvent",
   "NtOpenMutant",
   "NtOpenObjectAuditAlarm",
   "NtOpenPartition",
   "NtOpenPrivateNamespace",
   "NtOpenProcess",
   "NtOpenProcessToken",
   "NtOpenProcessTokenEx",
   "NtOpenRegistryTransaction",
   "NtOpenResourceManager",
   "NtOpenSection",
   "NtOpenSemaphore",
   "NtOpenSession",
   "NtOpenSymbolicLinkObject",
   "NtOpenThread",
   "NtOpenThreadToken",
   "NtOpenThreadTokenEx",
   "NtOpenTimer",
   "NtOpenTransaction",
   "NtOpenTransactionManager",
   "NtPlugPlayControl",
   "NtPowerInformation",
   "NtPrePrepareComplete",
   "NtPrePrepareEnlistment",
   "NtPrepareComplete",
   "NtPrepareEnlistment",
   "NtPrivilegeCheck",
   "NtPrivilegeObjectAuditAlarm",
   "NtPrivilegedServiceAuditAlarm",
   "NtPropagationComplete",
   "NtPropagationFailed",
   "NtProtectVirtualMemory",
   "NtPulseEvent",
   "NtQueryAttributesFile",
   "NtQueryAuxiliaryCounterFrequency",
   "NtQueryBootEntryOrder",
   "NtQueryBootOptions",
   "NtQueryDebugFilterState",
   "NtQueryDefaultLocale",
   "NtQueryDefaultUILanguage",
   "NtQueryDirectoryFile",
   "NtQueryDirectoryFileEx",
   "NtQueryDirectoryObject",
   "NtQueryDriverEntryOrder",
   "NtQueryEaFile",
   "NtQueryEvent",
   "NtQueryFullAttributesFile",
   "NtQueryInformationAtom",
   "NtQueryInformationByName",
   "NtQueryInformationEnlistment",
   "NtQueryInformationFile",
   "NtQueryInformationJobObject",
   "NtQueryInformationPort",
   "NtQueryInformationProcess",
   "NtQueryInformationResourceManager",
   "NtQueryInformationThread",
   "NtQueryInformationToken",
   "NtQueryInformationTransaction",
   "NtQueryInformationTransactionManager",
   "NtQueryInformationWorkerFactory",
   "NtQueryInstallUILanguage",
   "NtQueryIntervalProfile",
   "NtQueryIoCompletion",
   "NtQueryKey",
   "NtQueryLicenseValue",
   "NtQueryMultipleValueKey",
   "NtQueryMutant",
   "NtQueryObject",
   "NtQueryOpenSubKeys",
   "NtQueryOpenSubKeysEx",
   "NtQueryPerformanceCounter",
   "NtQueryPortInformationProcess",
   "NtQueryQuotaInformationFile",
   "NtQuerySection",
   "NtQuerySecurityAttributesToken",
   "NtQuerySecurityObject",
   "NtQuerySecurityPolicy",
   "NtQuerySemaphore",
   "NtQuerySymbolicLinkObject",
   "NtQuerySystemEnvironmentValue",
   "NtQuerySystemEnvironmentValueEx",
   "NtQuerySystemInformation",
   "NtQuerySystemInformationEx",
   "NtQueryTimer",
   "NtQueryTimerResolution",
   "NtQueryValueKey",
   "NtQueryVirtualMemory",
   "NtQueryVolumeInformationFile",
   "NtQueryWnfStateData",
   "NtQueryWnfStateNameInformation",
   "NtQueueApcThread",
   "NtQueueApcThreadEx",
   "NtRaiseException",
   "NtRaiseHardError",
   "NtReadFile",
   "NtReadFileScatter",
   "NtReadOnlyEnlistment",
   "NtReadRequestData",
   "NtReadVirtualMemory",
   "NtRecoverEnlistment",
   "NtRecoverResourceManager",
   "NtRecoverTransactionManager",
   "NtRegisterProtocolAddressInformation",
   "NtRegisterThreadTerminatePort",
   "NtReleaseKeyedEvent",
   "NtReleaseMutant",
   "NtReleaseSemaphore",
   "NtReleaseWorkerFactoryWorker",
   "NtRemoveIoCompletion",
   "NtRemoveIoCompletionEx",
   "NtRemoveProcessDebug",
   "NtRenameKey",
   "NtRenameTransactionManager",
   "NtReplaceKey",
   "NtReplacePartitionUnit",
   "NtReplyPort",
   "NtReplyWaitReceivePort",
   "NtReplyWaitReceivePortEx",
   "NtReplyWaitReplyPort",
   "NtRequestPort",
   "NtRequestWaitReplyPort",
   "NtResetEvent",
   "NtResetWriteWatch",
   "NtRestoreKey",
   "NtResumeProcess",
   "NtResumeThread",
   "NtRevertContainerImpersonation",
   "NtRollbackComplete",
   "NtRollbackEnlistment",
   "NtRollbackRegistryTransaction",
   "NtRollbackTransaction",
   "NtRollforwardTransactionManager",
   "NtSaveKey",
   "NtSaveKeyEx",
   "NtSaveMergedKeys",
   "NtSecureConnectPort",
   "NtSerializeBoot",
   "NtSetBootEntryOrder",
   "NtSetBootOptions",
   "NtSetCachedSigningLevel",
   "NtSetCachedSigningLevel2",
   "NtSetContextThread",
   "NtSetDebugFilterState",
   "NtSetDefaultHardErrorPort",
   "NtSetDefaultLocale",
   "NtSetDefaultUILanguage",
   "NtSetDriverEntryOrder",
   "NtSetEaFile",
   "NtSetEvent",
   "NtSetEventBoostPriority",
   "NtSetHighEventPair",
   "NtSetHighWaitLowEventPair",
   "NtSetIRTimer",
   "NtSetInformationDebugObject",
   "NtSetInformationEnlistment",
   "NtSetInformationFile",
   "NtSetInformationJobObject",
   "NtSetInformationKey",
   "NtSetInformationObject",
   "NtSetInformationProcess",
   "NtSetInformationResourceManager",
   "NtSetInformationSymbolicLink",
   "NtSetInformationThread",
   "NtSetInformationToken",
   "NtSetInformationTransaction",
   "NtSetInformationTransactionManager",
   "NtSetInformationVirtualMemory",
   "NtSetInformationWorkerFactory",
   "NtSetIntervalProfile",
   "NtSetIoCompletion",
   "NtSetIoCompletionEx",
   "NtSetLdtEntries",
   "NtSetLowEventPair",
   "NtSetLowWaitHighEventPair",
   "NtSetQuotaInformationFile",
   "NtSetSecurityObject",
   "NtSetSystemEnvironmentValue",
   "NtSetSystemEnvironmentValueEx",
   "NtSetSystemInformation",
   "NtSetSystemPowerState",
   "NtSetSystemTime",
   "NtSetThreadExecutionState",
   "NtSetTimer",
   "NtSetTimer2",
   "NtSetTimerEx",
   "NtSetTimerResolution",
   "NtSetUuidSeed",
   "NtSetValueKey",
   "NtSetVolumeInformationFile",
   "NtSetWnfProcessNotificationEvent",
   "NtShutdownSystem",
   "NtShutdownWorkerFactory",
   "NtSignalAndWaitForSingleObject",
   "NtSinglePhaseReject",
   "NtStartProfile",
   "NtStopProfile",
   "NtSubscribeWnfStateChange",
   "NtSuspendProcess",
   "NtSuspendThread",
   "NtSystemDebugControl",
   "NtTerminateEnclave",
   "NtTerminateJobObject",
   "NtTerminateProcess",
   "NtTerminateThread",
   "NtTestAlert",
   "NtThawRegistry",
   "NtThawTransactions",
   "NtTraceControl",
   "NtTraceEvent",
   "NtTranslateFilePath",
   "NtUmsThreadYield",
   "NtUnloadDriver",
   "NtUnloadKey",
   "NtUnloadKey2",
   "NtUnloadKeyEx",
   "NtUnlockFile",
   "NtUnlockVirtualMemory",
   "NtUnmapViewOfSection",
   "NtUnmapViewOfSectionEx",
   "NtUnsubscribeWnfStateChange",
   "NtUpdateWnfStateData",
   "NtVdmControl",
   "NtWaitForAlertByThreadId",
   "NtWaitForDebugEvent",
   "NtWaitForKeyedEvent",
   "NtWaitForMultipleObjects",
   "NtWaitForMultipleObjects32",
   "NtWaitForSingleObject",
   "NtWaitForWorkViaWorkerFactory",
   "NtWaitHighEventPair",
   "NtWaitLowEventPair",
   "NtWorkerFactoryWorkerReady",
   "NtWriteFile",
   "NtWriteFileGather",
   "NtWriteRequestData",
   "NtWriteVirtualMemory",
   "NtYieldExecution"
};

uint32_t syscall_table[SYSCALL_TABLE_MAX] = { (uint32_t)-1 };

extern "C" uint32_t get_syscall_by_name(const char* name) {

    if (!is_syscall_table_initialized()) {

        return -1;
    }

    for (size_t idx = 0; idx < SYSCALL_TABLE_MAX; idx++) {

        if (!strcmp(name, syscall_table_names[idx])) {

            return syscall_table[idx];
        }
    }

    return -1;
}

extern "C" uint32_t get_syscall_by_idx(syscall_table_enum idx) {

    return syscall_table[idx];
}

extern "C" const char* get_syscall_name_by_idx(syscall_table_enum idx) {

    return syscall_table_names[idx];
}

extern "C" void set_syscall_by_idx(syscall_table_enum idx, uint32_t syscall_idx) {

    syscall_table[idx] = syscall_idx;
}